import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient({
  log: ["info"],
});

const ct = `<p style="margin-left:0px;"><mark class="marker-yellow">Testing short first paragraph Testing short first paragraph Testing short first paragraph Testing short first paragraph Testing short first paragraph</mark></p><p style="margin-left:0px;">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam non dictum nisl. Nam nisl ipsum, pulvinar consequat neque ut, venenatis suscipit nulla. Ut felis dolor, efficitur at ex ut, semper tempor felis. Praesent sit amet erat euismod, bibendum arcu eget, maximus quam. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Vivamus finibus urna in urna euismod, a ultricies ipsum iaculis. Praesent vitae nisl sit amet eros eleifend tempus. Mauris posuere varius quam, eget ultricies magna porttitor non. Aliquam rutrum libero eu leo tempor sagittis. Vivamus euismod aliquam est in ornare. Cras mattis mattis libero eu elementum. Integer id efficitur purus, ut sollicitudin arcu.</p><p style="margin-left:0px;">Nam lobortis, ipsum ac sagittis viverra, tellus dui dictum dui, ac vehicula quam augue sit amet elit. Aliquam rutrum sem vel dui gravida feugiat. Phasellus mi est, tempus non tristique eu, lacinia a tellus. Sed sollicitudin at dui non commodo. Ut vitae ipsum non metus dapibus lobortis. Nunc dapibus congue feugiat. Fusce luctus velit nunc, et pharetra turpis tincidunt vel. Aliquam quis sem sit amet nisi gravida pellentesque. Mauris condimentum scelerisque feugiat.</p><p style="margin-left:0px;">Morbi nisi tellus, fringilla at lacus sed, vulputate convallis massa. Pellentesque id pretium nunc. Nullam a venenatis purus. Vestibulum placerat est eget nulla pulvinar molestie. Duis maximus ultricies aliquet. Morbi accumsan neque vitae ante vehicula, in iaculis dui ultrices. Donec facilisis, arcu quis aliquam varius, metus velit accumsan ipsum, quis condimentum augue odio et ipsum. Etiam non urna nunc. Integer vehicula, dolor scelerisque sagittis vestibulum, erat urna fringilla eros, vel ultrices quam neque in nunc. Fusce blandit elementum leo, eget egestas nulla. Vestibulum condimentum enim a ligula posuere blandit. Aenean pretium pellentesque neque, vel rhoncus nulla vulputate sit amet. In scelerisque feugiat quam nec congue.</p><p style="margin-left:0px;">Donec ut dolor luctus, congue erat ac, iaculis nisi. Mauris vel venenatis dolor, quis ullamcorper urna. Etiam volutpat sagittis aliquam. Vivamus vehicula volutpat venenatis. Praesent condimentum lectus ut lorem tristique scelerisque. Maecenas elementum velit id volutpat tempus. Curabitur nec odio sit amet orci laoreet molestie. Morbi lacinia consectetur condimentum. Nunc ullamcorper nisl vehicula ligula rhoncus eleifend. Interdum et malesuada fames ac ante ipsum primis in faucibus. Sed nec vulputate lorem. Nulla eget accumsan urna. Cras rutrum elit felis, et euismod nisi finibus vitae. Nunc sagittis tristique nisi, quis luctus metus condimentum in. Nam pulvinar venenatis pulvinar. Sed urna neque, sollicitudin sit amet dictum nec, varius nec ante.</p><p style="margin-left:0px;">Praesent eu porttitor arcu. Nullam sodales, diam at commodo finibus, odio arcu luctus elit, in ultricies purus orci sit amet mi. Proin iaculis malesuada sapien at maximus. Praesent pulvinar nisl a felis hendrerit efficitur. Praesent faucibus mauris eu placerat ornare. Morbi iaculis efficitur elementum. Etiam scelerisque, nisi non malesuada tempus, quam justo feugiat magna, quis sollicitudin dui ligula vel ligula. Curabitur dapibus massa nulla, at porta sem aliquet eget. Suspendisse ultricies maximus nisi, imperdiet porttitor libero.</p><p style="margin-left:0px;">Pellentesque pretium est ac dictum facilisis. Aenean ipsum orci, pretium vel mattis ac, viverra vel massa. Mauris interdum massa nec nisi interdum dictum. Donec vulputate ipsum ut nisi euismod imperdiet. Nunc nunc velit, maximus a dictum vitae, consectetur non nulla. Cras sed ultrices felis. Vivamus blandit est volutpat elit malesuada commodo. Curabitur sagittis vulputate dui, pellentesque dapibus neque volutpat a. Vestibulum luctus non orci eget rutrum. Nunc pellentesque, justo vitae lacinia vestibulum, nisi erat cursus leo, mollis viverra tellus metus in lacus. Ut vitae erat tellus. Nunc sapien lacus, feugiat quis suscipit non, fermentum eget arcu. In hac habitasse platea dictumst. Donec eu ligula sit amet justo hendrerit feugiat. Suspendisse varius lorem vel maximus mattis. Duis hendrerit tincidunt orci, et ultrices leo feugiat id.</p><p style="margin-left:0px;">Duis facilisis blandit orci at aliquam. Vestibulum imperdiet eget eros vitae maximus. Praesent ligula odio, placerat vel vulputate sit amet, vestibulum id nulla. Morbi facilisis vestibulum tellus sit amet tristique. Aenean eleifend auctor nisi, sed pretium sem laoreet a. Nulla facilisi. Curabitur in interdum ligula. Mauris pellentesque erat urna, eu rutrum tellus semper eu. Nullam vel lorem vitae diam dignissim condimentum. Aenean interdum convallis placerat. Curabitur ut congue ex. Nunc condimentum nisi vel faucibus vulputate.</p><p style="margin-left:0px;">Suspendisse rutrum mattis quam, in volutpat nibh condimentum a. Praesent libero orci, ultricies tincidunt neque sed, aliquam rhoncus leo. Etiam sodales lectus et erat lacinia, quis imperdiet risus consequat. Mauris nec nisi rutrum, facilisis turpis nec, fringilla ipsum. Pellentesque eget fermentum risus, vitae sodales nibh. Nulla volutpat vehicula nisi non condimentum. Sed imperdiet fermentum ante ut laoreet. Aenean ullamcorper sed leo nec sagittis. Aliquam nunc leo, pulvinar ut tincidunt et, sagittis sit amet urna. Curabitur vitae ornare lacus. Vestibulum fermentum ornare tellus varius lobortis. Fusce sit amet imperdiet turpis.</p><p style="margin-left:0px;">Vestibulum ac ante ut libero sodales fringilla quis in urna. Donec iaculis, nulla in interdum eleifend, erat tortor finibus orci, tincidunt porta lectus massa ac sem. Etiam viverra sollicitudin neque ac luctus. Nunc vehicula elit in arcu bibendum semper. Phasellus convallis leo ex, lobortis lacinia nibh iaculis sed. Cras posuere interdum risus, id fermentum nunc commodo id. Pellentesque sit amet mauris erat. Praesent posuere varius dolor, nec molestie arcu tincidunt id. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam semper quam ac neque ullamcorper, ut accumsan ante convallis. Fusce diam lectus, bibendum eget felis sed, hendrerit tincidunt urna.</p><p style="margin-left:0px;">Etiam posuere felis sed purus laoreet, a gravida mauris sagittis. Integer id libero vitae quam aliquam commodo. Cras id velit orci. Aliquam lobortis et lorem nec bibendum. Vestibulum sit amet ultrices dui. Aliquam erat volutpat. Curabitur aliquet, nulla in rhoncus fermentum, nunc justo bibendum magna, vitae vestibulum dui nunc laoreet risus. Vivamus ac aliquet ante. Nullam sit amet bibendum risus, vel consequat neque. Integer ac fringilla libero, eget efficitur nisl. Praesent fermentum nunc non mauris pellentesque, posuere suscipit justo vehicula. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.</p>`;

const getExcerpt = (content: string) => {
  const paragraphRegex = /<p(.*?)>(.*?)<\/p>/g;
  const matches = content.match(paragraphRegex);
  if (!matches) return;
  for (let exceprtIndex = 0; exceprtIndex < matches.length; exceprtIndex++) {
    const exceprtParagraph = matches[exceprtIndex];
    // arbitrary length that is too short for a good excerpt
    if (exceprtParagraph.length < 50) {
      continue;
    } else {
      console.log(exceprtParagraph.length);
      return matches[exceprtIndex];
    }
  }
};

console.log(getExcerpt(ct));
